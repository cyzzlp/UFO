/*
    \振镜官方提供的二次开发api
*/


#ifndef CSCINTERFACE_H
#define CSCINTERFACE_H

#define IN
#define OUT
//#####################################################################################################
//#############################################################################################基本函数
/****************************************************************************************************
函数名    :  OpenUSB_Board
功能      :  打开CSC-USB卡的函数
参数      :  deviceIndex:   USB的设备索引号
             handle:    窗体句柄,当handle=NULL时，窗体未定义，不支持PnP事件
返回值    :  1: 成功
            -1: 打开板卡失败
            -2: USB接口不是2.0接口
            -3: 开辟32M内存区失败
            -4: 板卡内时间大于当前计算机时间
            -5: 授权到期
-----------------------------------------------------------------------------------------------------
备注     :  若有一块CSC-USB卡, deviceIndex为0;
            若有二块CSC-USB卡, 第一块CSC-USB卡的索引号 deviceIndex为0;
                               第二块CSC-USB卡的索引号 deviceIndex为1;
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall OpenUSB_Board(int deviceIndex, void* handle);

/****************************************************************************************************
函数名:    LoadFPGA_FirmwareProgram
功能    :  加载硬件程序
参数    :
           rbfFilePath: 驱动文件所在的位置，绝对路径
返回值:    1:  硬件程序加载成功
           -1: 驱动文件未找到
           -2: 硬件程序加载失败
-----------------------------------------------------------------------------------------------------
备注     : 该函数必须在OpenUSB_Board后立即调用，否则其他接口函数不能正常使用
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall LoadFPGA_FirmwareProgram(IN char* rbfFilePath);

/****************************************************************************************************
函数名   : SetLaserMode
功能     : 设置激光器模式
参数     :
           laserType
               0: YAG激光器
               1: CO2激光器
               2: IPG光纤激光器
               3: SPI光纤激光器
               默认值: 1
           standby:预电离  1,开启预电离; 0,取消预电离 默认值: 0
           frequency: 预电离频率, 范围:10-100Khz ,默认20 Khz
           pulseWidth: 预电离脉宽, 范围:10%-90% ,默认10%
返回值   : 1:  激光器设置成功
           -1: 激光器设置失败
-----------------------------------------------------------------------------------------------------
备注     : 1、仅在CO2和IPG激光器下可设置 standby
           2、在LoadMarkParameters之前调用
           3、frequency 和 pulseWidth 只有在IPG下可设置
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall SetLaserMode(IN int laserType, IN int standby, IN float frequency, IN float pulseWidth);


/****************************************************************************************************
函数名   : SetSystemParameters
功能     : 初始化系统参数
参数     :

            rangeX X轴标刻范围  单位:mm 默认值: 110
            rangeY Y轴标刻范围  单位:mm 默认值: 110
            exchangeXY XY轴坐标是否互换 默认值: false
            invertX X轴坐标是否反向 默认值: false
            invertY Y轴坐标是否反向 默认值: false
            startMarkMode 启动打标的模式 0:自动启动 1:事件控制启动 默认值: 0
返回值   : 1 : 函数执行成功
          -1 : 函数执行失败
-----------------------------------------------------------------------------------------------------
备注     :  该函数应在LoadMarkParameters函数之前调用，否则按默认值处理
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
int  __stdcall SetSystemParameters(IN double rangeX, IN double rangeY,
    IN bool exchangeXY, IN bool invertX, IN bool invertY, IN int startMarkMode);

/****************************************************************************************************
函数名   : SetCorrectParameters_0
功能     : 设置公式法校正的参数，并选定校正模式为公式法校正
参数     :

            xCorrection  X轴失真校正系数  默认值: 0
            yCorrection  Y轴失真校正系数  默认值: 0
            xShear	X轴切变校正系数  默认值: 0
            yShear	Y轴切变校正系数  默认值: 0
            xLadder	X轴梯形校正系数  默认值: 0
            xLadder	Y轴梯形校正系数  默认值: 0
            ratioX       X轴比例系数 默认值: 1
            ratioY       Y轴比例系数 默认值: 1
            ratioZ       Z轴补偿比例系数 默认值: 1
返回值   : 1 : 函数执行成功
          -1 : 函数执行失败
-----------------------------------------------------------------------------------------------------
备注     :  公式校正法操作较简单，一般用于精度要求不高的应用
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
int  __stdcall SetCorrectParameters_0(IN double xCorrection, IN double yCorrection,
    IN double xShear, IN double yShear, IN double xLadder, IN double yLadder,
    IN double ratioX, IN double ratioY, IN double ratioZ);

/****************************************************************************************************
函数名   : SetCorrectParameters_1
功能     : 设置校正表法校正的参数，并选定校正模式为校正表法校正
参数     :

            ratioX       X轴比例系数 默认值: 1
            ratioY       Y轴比例系数 默认值: 1
            ratioZ       Z轴补偿比例系数 默认值: 1
            filePath 校正表法校正文件的路径
返回值   : 1 : 函数执行成功
          -1 : 函数执行失败
-----------------------------------------------------------------------------------------------------
备注     :  校正表法校正用于高精度的应用
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
int  __stdcall SetCorrectParameters_1(IN double ratioX, IN double ratioY, IN double ratioZ, IN char* filePath);

/****************************************************************************************************
函数名   : WriteDataEnd
功能     : 通知算数结束
参数     :
返回值   : 无
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
void __stdcall WriteDataEnd();

/****************************************************************************************************
函数名   : SetOverallMarkCounts
功能     : 设置整体标刻次数,0为循环，1为标刻1次，2为标刻2次，...65535次
参数     :

            count : 标刻次数,范围: 0-65535；0为循环
返回值   : 无
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
void __stdcall SetOverallMarkCounts(IN int count);

/****************************************************************************************************
函数名   : IsReadDataEnd
功能     : 是否已经将数据全部送至控制卡
参数     :
返回值   : true:  已经送完
           false: 尚未完成
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
bool __stdcall IsReadDataEnd();

/****************************************************************************************************
函数名   : IsMarkEnd
功能     : 标刻是否已经结束
参数     :
返回值   : true:  已经结束
           false: 正在标刻
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
bool __stdcall IsMarkEnd();

/****************************************************************************************************
函数名   : StartMark
功能     : 开始标刻
参数     :
返回值   : true:  启动标刻成功
           false: 启动标刻失败
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
bool __stdcall StartMark();

/****************************************************************************************************
函数名   : GetProducedData
功能     : 本次标刻已分解的数据量
参数     :
返回值   : 数据量单位:字节
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
unsigned __int64 __stdcall GetProducedData();

/****************************************************************************************************
函数名   : SetMarkParameter
功能     : 修改指定层号的标刻参数
参数     :
            index,                 //层号， (0-255)
            markCounts,            //标刻次数(1 - 65535)
            isBitmap,              //是否是位图
            markSpeed,             //标刻速度(mm/s)
            jumpSpeed,             //跳转速度(mm/s)
            jumpDelay,             //跳转延时(us)
            polygonDelay,          //拐点延时(us)
            laserOnDelay,          //开光延时(us)
            laserOffDelay,         //关光延时(us)
            polygonKillerTime,     //拐点抑制时间(us)
            laserFrequency,        //激光频率(kHZ)
            current,               //YAG、SPI电流、IPG能量(%)
            firstPulseKillerLength,//YAG 首脉冲抑制脉宽(us)
            pulseWidth,            //脉冲宽度(us)
            firstPulseWidth,       //CO2首脉冲宽度(%)
            incrementStep,         //CO2首脉冲抑制增量步长(%)
            dotSpace,              //点间距,单位(mm))

返回值    :  1: 执行成功
            -1: 执行失败
-----------------------------------------------------------------------------------------------------
备注     :   控制卡最多 256 组标刻参数
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall SetMarkParameter(
    IN int index,                   //层号
    IN int markCounts,              //标刻次数
    IN int isBitmap,                //是否是位图
    IN float markSpeed,             //标刻速度(mm/s)
    IN float jumpSpeed,             //跳转速度(mm/s)
    IN float jumpDelay,             //跳转延时(us)
    IN float polygonDelay,          //拐点延时(us)
    IN float laserOnDelay,          //开光延时(us)
    IN float laserOffDelay,         //关光延时(us)
    IN float polygonKillerTime,     //拐点抑制时间(us)
    IN float laserFrequency,        //激光频率(kHZ)
    IN float current,               //YAG、SPI电流、IPG能量(%)
    IN float firstPulseKillerLength,//YAG 首脉冲抑制脉宽(us)
    IN float pulseWidth,            //脉冲宽度(us)
    IN float firstPulseWidth,       //CO2首脉冲宽度(%)
    IN float incrementStep,         //CO2首脉冲抑制增量步长(%)
    IN float dotSpace              //点间距,单位(mm))
);

/****************************************************************************************************
函数名   : DownloadMarkParameters
功能     : 将上位机设置的参数下载到CSC-USB卡中，并指定首先使用哪一组参数
参数     :
返回值   : true:执行成功
           false:执行失败
-----------------------------------------------------------------------------------------------------
备注     : 必须在SetSystemParameters、SetLaserMode之后，标刻前调用
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool  __stdcall DownloadMarkParameters();

/****************************************************************************************************
函数名:    SetFirstMarkParameter
功能    :  将参数加载到FPGA
参数    :
            pen: 笔号
返回值:    true:参数设置成功
           false:参数设置失败
-----------------------------------------------------------------------------------------------------
备注     : 主要用于设置第一个标刻对象的标刻参数
-----------------------------------------------------------------------------------------------------
作 者:
****************************************************************************************************/
bool __stdcall SetFirstMarkParameter(IN int pen);

/****************************************************************************************************
函数名   : ReadyMark
功能     : 准备标刻,这个函数用来做标刻前的准备工作,例如清空fifo,CSC-USB卡复位等,
           用户需在执行标刻前调用该函数
参数     :
返回值   : true:设置成功
           false:设置失败
-----------------------------------------------------------------------------------------------------
备注     : 启动ReadDataThread线程前调用
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall ReadyMark();

/****************************************************************************************************
函数名	:	ReadyPreview
功能    :	准备预览
参数	:
返回值:    true:  开始预览函数执行成功
           false: 开始预览函数执行失败
-----------------------------------------------------------------------------------------------------
备注     : 启动ReadDataThread线程前调用
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall ReadyPreview();

/****************************************************************************************************
函数名    :  StartReadDataThread
功能      :  启动送数线程将内存数据送给控制卡
参数      :
返回值:    true:  执行成功
           false: 执行失败
-----------------------------------------------------------------------------------------------------
备注      :  无
-----------------------------------------------------------------------------------------------------
作者      :
****************************************************************************************************/
bool __stdcall StartReadDataThread();

/****************************************************************************************************
函数名    :  ZeroCounter
功能      :  数据量计数器清零
参数	  :
返回值    :  1: 函数运行成功
            -1: 函数失败
-----------------------------------------------------------------------------------------------------
备注      :  在每次标刻数据分解之前，必须调用该函数
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall ZeroCounter();

/****************************************************************************************************
函数名   : StopMark
功能     : 终止标刻
参数     :
返回值   : true: 成功
           false: 失败
-----------------------------------------------------------------------------------------------------
备注     :  无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall StopMark();

/****************************************************************************************************
函数名	:  StopPreview
功能    :  终止预览
参数	:
返回值:    true:  成功
           false: 失败
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall StopPreview();

/****************************************************************************************************
函数名   : StopCalcData
功能     : 终止数据分解
参数     :
返回值   : true: 成功
false: 失败
-----------------------------------------------------------------------------------------------------
备注     :  数据量大于64M时，上位机会进入等待送数的循环中，如果要急停，则需要先终止这个循环等待，才能
停止上位机的送数
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall StopCalcData();

/****************************************************************************************************
函数名   : SetDelayPA_MO
功能     : 设置PA 延迟 MO信号的时间(ms)
参数     :
            delay: 延迟时间
返回值   : true:  设置成功
           false: 设置失败
-----------------------------------------------------------------------------------------------------
备注     : 无
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
bool __stdcall SetDelayPA_MO(IN float delay);

/****************************************************************************************************
函数名   : SPI_SimmerCurrent
功能     : 预燃电流
参数     :
            simmer: 范围0～100 单位(%)
返回值   : true:  设置成功
           false: 设置失败
-----------------------------------------------------------------------------------------------------
备注     : 无
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
bool __stdcall SPI_SimmerCurrent(IN double simmer);

/****************************************************************************************************
函数名   : SPI_ModeSelect
功能     : spi模式选择
参数     :
            mode: 0为脉冲模式，1为电平模式
返回值   : true:  设置成功
           false: 设置失败
-----------------------------------------------------------------------------------------------------
备注     : 无
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
bool __stdcall SPI_ModeSelect(IN int mode);

/****************************************************************************************************
函数名   : SPI_WaveForm
功能     : spi波形选择
参数     :
            wave: 激光器波形选择，对应J9接口的IO0~IO5输出口，软件设置0号波形～63号波形可选
返回值   : true:  设置成功
           false: 设置失败
-----------------------------------------------------------------------------------------------------
备注     : 无
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
bool __stdcall SPI_WaveForm(IN int wave);

/****************************************************************************************************
函数名    : SetExternalStartSignalMode
功能      : Start信号模式选择
参数      :
            mode 0为边沿脉冲触发，1为电平触发 默认值: 0
返回值    :  1: 函数运行成功
            -1: 函数失败
-----------------------------------------------------------------------------------------------------
备注      :  无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall SetExternalStartSignalMode(IN int mode);

/****************************************************************************************************
函数名    :  GetCSCInterfaceVersion
功能      :  获取函数库的版本号
参数      :
             version 指针,指向存放函数库版本号的内存地址
返回值    :  1: 函数运行成功,得到函数库的版本号
            -1: 函数失败
-----------------------------------------------------------------------------------------------------
备注      :  无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall GetCSCInterfaceVersion(OUT char* version);

/****************************************************************************************************
函数名   : OpenGuideLight
功能     : 打开指示光
参数     :
返回值   : true:打开指示光函数执行成功
           false:打开指示光函数执行失败
-----------------------------------------------------------------------------------------------------
备注     : 无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall OpenGuideLight();

/****************************************************************************************************
函数名   : CloseGuideLight
功能     : 关闭指示光
参数     :
返回值   : true:执行成功
           false:执行失败
-----------------------------------------------------------------------------------------------------
备注     : 无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall CloseGuideLight();

/****************************************************************************************************
函数名   :   CloseUSB_Board
功能     :  关闭CSC-USB卡的函数,释放内存
参数     :
返回值   :  无
-----------------------------------------------------------------------------------------------------
备注     :  在每次关闭程序时必须调用该函数，用以释放32M内存区
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
void __stdcall  CloseUSB_Board();
//#############################################################################################基本函数
//#####################################################################################################



//#####################################################################################################
//##############################################################################读取CSC-USB卡信息的函数
/****************************************************************************************************
函数名   : GetMarkStatus
功能     : 判断当前是否正在标刻
参数     :
返回值   : true: 正在标刻
           false: 不在标刻
-----------------------------------------------------------------------------------------------------
备注     :  无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall GetMarkStatus();

/****************************************************************************************************
函数名   : GetMarkTime
功能     : 获取标刻时间
参数     :
返回值   : long 标刻时间,单位毫秒(ms)
           0  :函数执行失败
-----------------------------------------------------------------------------------------------------
备注     : 标刻时间取值范围:0-4294967295(ms)
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
unsigned long __stdcall GetMarkTime();

/****************************************************************************************************
函数名   :	GetMarkCounts
功能     :	获得整体标刻次数
参数     :
            internalMarkCounts  内部触发标刻次数
            externalMarkCounts  外部触发标刻次数
返回值   : true: 函数执行成功,读取标刻次数
           false:函数执行失败,没有读到标刻次数
-----------------------------------------------------------------------------------------------------
备注     :  internalMarkCounts: 0-255
            externalMarkCounts: 1-255
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall GetMarkCounts(OUT unsigned char& internalMarkCounts, OUT unsigned char& externalMarkCounts);

/****************************************************************************************************
函数名   : GetUSB_BoardCounts
功能     : 获取当前主机连接CSC-USB卡的数量
参数     : 无
返回值   : CSC-USB卡数量
-----------------------------------------------------------------------------------------------------
备注     : 无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall GetUSB_BoardCounts();

/****************************************************************************************************
函数名    :  GetUSB_FirmwareVersion
功能      :  获取USB固件程序的版本号
参数      :
             version 指针,指向存放固件程序版本号的内存地址
返回值    :  1: 函数执行成功，得到固件程序版本号
            -1: 函数执行失败，得不到固件程序的版本号
-----------------------------------------------------------------------------------------------------
备注      :  无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall GetUSB_FirmwareVersion(OUT char* version);

/****************************************************************************************************
函数名    :  GetFPGA_FirmwareVersion
功能      :  获取FPGA固件程序的版本号
参数      :
             version 指针,指向存放固件程序版本号的内存地址
返回值    :  1: 函数运行成功,得到固件程序的版本号
            -1: 从CSC-USB卡读取数据失败，得不到固件程序的版本号
-----------------------------------------------------------------------------------------------------
备注      :  无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall GetFPGA_FirmwareVersion(OUT char* version);

/****************************************************************************************************
函数名   :	GetLaserAndScannerStatus
功能     :	获取振镜和激光器状态
参数     :
            laserStatus  :激光器状态，即是否正常运行
            scannerStatus:振镜状态，即是否正常运行
返回值   : true: 函数执行成功
           false: 函数执行失败
-----------------------------------------------------------------------------------------------------
备注     :  激光器状态2为正常;振镜状态0为正常
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall GetLaserAndScannerStatus(OUT int& laserStatus, OUT int& scannerStatus);

/****************************************************************************************************
函数名   :	ReadUSB_BoardSN
功能     :	读取CSC-USB卡序列号
参数     :
            boardSN: 指针,指向存放CSC-USB卡序列号的内存地址
返回值   : 1: 读取CSC-USB卡号成功
          -1: 读取CSC-USB卡号失败
-----------------------------------------------------------------------------------------------------
备注     : 无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall ReadUSB_BoardSN(OUT char* boardSN);

/****************************************************************************************************
函数名   :	ReadUSB_BoardSN
功能     :	读取CSC-USB卡序列号
参数     :	index: 控制卡的索引号，以0起始
            boardSN: 指针,指向存放CSC-USB卡序列号的内存地址
返回值   : 1: 读取CSC-USB卡号成功
          -1: 读取CSC-USB卡号失败
-----------------------------------------------------------------------------------------------------
备注     : 无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall ReadUSB_BoardSN_ByIndex(IN int index, OUT char* boardSN);


/****************************************************************************************************
函数名   :	GetScannerPosition
功能     :	获取振镜位置
参数     :
            xPos  X振镜位置，单位：mm
            yPos  Y振镜位置，单位：mm
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
bool __stdcall GetScannerPosition(OUT float& xPos, OUT float& yPos);
//##############################################################################读取CSC-USB卡信息的函数
//#####################################################################################################

//#####################################################################################################
//###########################################################################################开激光命令
/****************************************************************************************************
函数名   :  LaserSignalOn
功能     :  脉冲方式打开激光
参数	 :
返回值   :  false: 打开激光失败
            true:  打开激光成功
-----------------------------------------------------------------------------------------------------
备注     :  无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall LaserSignalOn();

/****************************************************************************************************
函数名    :  LaserSignalOff
功能      :  脉冲方式关闭激光
参数	  :
返回值    :  false: 关闭激光执行失败
             true:  关闭激光执行成功
-----------------------------------------------------------------------------------------------------
备注      :  无
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall LaserSignalOff();

//##########################################################################################开激光命令
//#####################################################################################################

//#####################################################################################################
//############################################################################################## AD命令
/****************************************************************************************************
函数名:    InitAD
功能	  :  初始化AD
参数	  :
返回值:    true:初始化AD成功
           false:初始化AD失败
-----------------------------------------------------------------------------------------------------
备注     : AD模拟数字转换器
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
bool __stdcall InitAD();

/****************************************************************************************************
函数名:    GetAD
功能    :  读取AD,得到AD的采样值
参数	:
返回值:    AD数据的采样值
           -1 : 正在标刻不能读取AD
           -2 : 读CSC-USB卡数据失败
-----------------------------------------------------------------------------------------------------
备注     : AD模拟数字转换器
-----------------------------------------------------------------------------------------------------
****************************************************************************************************/
int __stdcall GetAD();
//############################################################################################## AD命令
//#####################################################################################################

//#####################################################################################################
//############################################################################################# I/O命令
//////////////////////////////////////////////////////////////////////////////////////Control Command
/*************************************************************************************
函数名    :  Write_IO_Port
功能      :  设置输出端口号有效,输出端口只有1-4端口可用
参数      :
             port: 信号输出的端口号(port最大值为15)，
             1表示选中1号端口,3表示选中1、2端口
返回值    :  false: 设置的端口号无效,或者向CSC-USB卡送入数据失败
             true : 向CSC-USB卡送入选中端口号成功
--------------------------------------------------------------------------------------
备注      :  I/O控制接口中的Output
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall Write_IO_Port(IN unsigned char port);

/*************************************************************************************
函数名    :  GetOutputPortState
功能      :  获取输出端口当前输出状态,输出端口只有1-4端口可用
参数      :
返回值    :  1-4端口当前的输出状态，端口号1-4分别对应返回值相应二进制的0-3位
--------------------------------------------------------------------------------------
备注      :  I/O控制接口中的Output
--------------------------------------------------------------------------------------
*************************************************************************************/
unsigned char __stdcall GetOutputPortState();

/*************************************************************************************
函数名   : Read_IO_Port
功能     : 读取外控输入信号
参数     :
返回值   : data: 得到外控信号
           0   : 函数执行失败
--------------------------------------------------------------------------------------
备注     :  I/O控制接口中的Input
--------------------------------------------------------------------------------------
*************************************************************************************/
unsigned short __stdcall Read_IO_Port();

/*************************************************************************************
函数名   :	GetExternalStartStopSignal
功能     :	读取外部启停信号
参数     :
            start:外部输入的开始标刻信号,0有效
            stop: 外部输入的停止标刻信号,0有效
返回值   : true: 函数执行成功
           false: 函数执行失败
--------------------------------------------------------------------------------------
备注     :  无
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall GetExternalStartStopSignal(OUT int& start, OUT int& stop);

/*************************************************************************************
函数名   : ResetStartStopSignal
功能     : 重置Start/Stop信号的接口函数
参数     :
返回值   :
true  :   执行成功
false :   执行失败
--------------------------------------------------------------------------------------
备注     :  无
2011-2-18 zhy 樊工添加重置Start信号的接口函数
2011-11-21 zhy 樊工添加重置Stop信号的接口函数
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall ResetStartStopSignal();
//////////////////////////////////////////////////////////////////////////////////////Control Command

/////////////////////////////////////////////////////////////////////////////////////////List Command
/****************************************************************************************
函数名   : InputCommand
功能     : 输入命令
参数     :
            port 指定的输入端口
返回值   : 1: 成功
          -1: 失败
-----------------------------------------------------------------------------------------
备注     : 标刻执行过程中遇到输入命令后开始等待，直到收到相应输入信号才会继续执行
-----------------------------------------------------------------------------------------
作者     :
****************************************************************************************/
int  __stdcall  InputCommand(IN unsigned char port);

/****************************************************************************************
函数名   : OutputCommand
功能     : 输出命令
参数     :

            port 指定的输出端口
            outMode 输出模式，0为电平方式，1为脉冲方式
            level 电平选择，0为低电平有效，1为高电平有效
            outputPulseWidth 输出延时  单位:us
返回值   : 1: 成功
          -1: 失败
-----------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------
作者     :
****************************************************************************************/
int  __stdcall  OutputCommand(IN unsigned char port, IN int outMode, IN int level, IN int outputPulseWidth);
/////////////////////////////////////////////////////////////////////////////////////////List Command
//############################################################################################# I/O命令
//#####################################################################################################

//#####################################################################################################
//######################################################################################## 步进电机命令

//////////////////////////////////////////////////////////////////////////////////////Control Command
/****************************************************************************************************
函数名   : SetStepMotorParameters
功能     : 步进电机系统参数设置
参数     :

            motorType         标识这是哪一轴的参数，0：x轴、1：y轴、2：z轴、3：R轴
            direction         方向,0为正向,1为反向 默认值: 0
            pitch             螺距  单位:mm        默认值: 4
            pulsePerRevolution    每转脉冲数       默认值: 200
            subdivision       细分数   默认值: 1
            correctionFactor      误差比例校正系数  默认值: 1
            reductionRatio    减速器的减速比  默认值: 1
            startSpeed        起始速度 单位：脉冲/s 默认值: 200
            speed         速度 单位：脉冲/s  默认值: 200
            speedupTime       加速时间  单位：ms  默认值: 0
返回值   : 1 : 函数执行成功
          -1 : 函数执行失败
-----------------------------------------------------------------------------------------------------
备注     :  使用步进电机前必须设置该系统参数，否则使用默认参数
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
int __stdcall SetStepMotorParameters(IN int motorType, IN int direction, IN float pitch, IN float pulsePerRevolution,
    IN float subdivision, IN float correctionFactor, IN float reductionRatio,
    IN float startSpeed, IN float speed, IN float speedupTime);

/*************************************************************************************
函数名   :	SetStepMotorLimitDirect
功能     :	设置步进电机限位方向
参数     :
            direction步进电机正反转设置,0为正转 1为反转
返回值   : true:设置成功
           false:设置失败
--------------------------------------------------------------------------------------
备注     :  参数格式如下：
            rZero=! rLimit，zZero =! zLimit，yZero=! yLimit，xZero =! xLimit
            direction =rLimit*128+rZero*64+zLimit*32+zZero*16+yLimit*8+yZero*4+xLimit*2+xZero
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall SetStepMotorLimitDirect(IN int direction);

/**************************************************************************************************************
函数名   : StepMotorZeroCounter
功能     : 清零步进电机位置计数器
参数     :
            type : 轴的类型 0:X 1:Y 2:Z 3:R
返回值   : true  :   执行成功
           false  :   执行失败
--------------------------------------------------------------------------------------------------------------
备注     : 无
--------------------------------------------------------------------------------------------------------------
作者     :
**************************************************************************************************************/
bool __stdcall StepMotorZeroCounter(IN int type);

/*************************************************************************************
函数名   : GetStepMotorPosition
功能     : 获取步进电机的当前位置
参数     :
           stepMotorType=0 x轴
                        =1 y轴
                        =2 z轴
                        =3 r轴
           motorCurPos 步进电机的当前位置,单位mm
返回值   : true 函数执行成功
           false 函数执行失败
--------------------------------------------------------------------------------------
备注     :  motorCurPos获取的是从CSC-USB卡开始上电后步进电机某一轴运行的累计距离的总和
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall GetStepMotorPosition(IN int stepMotorType, OUT float& motorCurPos);

/*************************************************************************************
函数名:    GetStepMotorHomeStatus
功能    :  获取步进电机零位状态
参数    :
           xhome:步进电机X轴零位状态,true,到达零位;false,没到达零位
           yhome:步进电机Y轴零位状态,true,到达零位;false,没到达零位
           zhome:步进电机Z轴零位状态,true,到达零位;false,没到达零位
           rhome:步进电机R轴零位状态,true,到达零位;false,没到达零位
--------------------------------------------------------------------------------------
备注     : 无
--------------------------------------------------------------------------------------
*************************************************************************************/
void __stdcall GetStepMotorHomeStatus(OUT bool& xhome, OUT bool& yhome, OUT bool& zhome, OUT bool& rhome);

/*************************************************************************************
函数名:    GetStepMotorLimitStatus
功能    :  获取步进电机限位状态
参数    :
           xlimit:步进电机X轴限位状态,true,到达限位;false,没到达限位
           ylimit:步进电机Y轴限位状态,true,到达限位;false,没到达限位
           zlimit:步进电机Z轴限位状态,true,到达限位;false,没到达限位
           rlimit:步进电机R轴限位状态,true,到达限位;false,没到达限位
--------------------------------------------------------------------------------------
备注     : 无
--------------------------------------------------------------------------------------
*************************************************************************************/
void __stdcall GetStepMotorLimitStatus(OUT bool& xlimit, OUT bool& ylimit, OUT bool& zlimit, OUT bool& rlimit);

/**************************************************************************************************************
函数名:    GetStepMotorStatus
功能    :  步进电机步进状态
参数    :
            xMotor:步进电机X轴步进状态,true,正在步进,false,步进结束
            yMotor:步进电机Y轴步进状态,true,正在步进,false,步进结束
            zMotor:步进电机Z轴步进状态,true,正在步进,false,步进结束
            rMotor:步进电机R轴步进状态,true,正在步进,false,步进结束
--------------------------------------------------------------------------------------------------------------
备注  :
--------------------------------------------------------------------------------------------------------------
作 者 :
**************************************************************************************************************/
void __stdcall GetStepMotorStatus(OUT bool& xMotor, OUT bool& yMotor, OUT bool& zMotor, OUT bool& rMotor);

/*************************************************************************************
函数名   : ReturnHome_X
功能     : X轴步进电机回零
参数     :
            frequency 步进电机移动的频率
返回值   : true 函数执行成功
false 函数执行失败
--------------------------------------------------------------------------------------
备注     : frequency的取值范围:1-1000000(HZ)
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall ReturnHome_X(IN unsigned long frequency);

/*************************************************************************************
函数名   : StartStepMotor_X
功能     : X轴步进电机步进
参数     :
            distance  移动的距离,单位:mm
            frequency 步进电机控制信号的频率,单位:脉冲/s
            startFrequency 起始频率，脉冲/s
            speedUpTime    加速时间，us
返回值   : true 函数执行成功
           false 函数执行失败
--------------------------------------------------------------------------------------
备注     :  frequency的取值范围:1-1000000(HZ)
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall StartStepMotor_X(IN float distance, IN unsigned long frequency,
    IN unsigned long startFrequency, IN unsigned long speedUpTime);


/*************************************************************************************
函数名   : StopStepMotor_X
功能     : X轴停止转动
参数     :
返回值   : true  :   执行成功
           false :   执行失败
--------------------------------------------------------------------------------------
备注     :  无
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall StopStepMotor_X();

/*************************************************************************************
函数名   : ReturnHome_Y
功能     : Y轴步进电机回零
参数     :
            frequency 步进电机移动的频率
返回值   : true 函数执行成功
false 函数执行失败
--------------------------------------------------------------------------------------
备注     : frequency的取值范围:1-1000000(HZ)
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall ReturnHome_Y(IN unsigned long frequency);


/*************************************************************************************
函数名   : StartStepMotor_Y
功能     : Y轴步进电机步进
参数     :
           distance  移动的距离,单位:mm
           frequency 步进电机控制信号的频率,单位:脉冲/s
           startFrequency 起始频率，脉冲/s
           speedUpTime    加速时间，us
返回值   : true 函数执行成功
           false 函数执行失败
--------------------------------------------------------------------------------------
备注     :  frequency的取值范围:1-1000000(HZ)
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall StartStepMotor_Y(IN float distance, IN unsigned long frequency,
    IN unsigned long startFrequency, IN unsigned long speedUpTime);

/*************************************************************************************
函数名   : StopStepMotor_Y
功能     : Y轴停止转动
参数     :
返回值   : true  :   执行成功
           false :   执行失败
--------------------------------------------------------------------------------------
备注     :  无
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall StopStepMotor_Y();

/*************************************************************************************
函数名   : ReturnHome_Z
功能     : Z轴步进电机回零
参数     :
            frequency 步进电机控制信号的频率,单位:脉冲/s
返回值   : true 函数执行成功
           false 函数执行失败
--------------------------------------------------------------------------------------
备注     : frequency的取值范围:1-1000000(HZ)
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall ReturnHome_Z(IN unsigned long frequency);


/*************************************************************************************
函数名   : StartStepMotor_Z
功能     : Z轴步进电机步进
参数     :
            distance  移动的距离,单位:mm
            frequency 步进电机控制信号的频率,单位:脉冲/s
            startFrequency 起始频率，脉冲/s
            speedUpTime    加速时间，us
返回值   : true 函数执行成功
           false 函数执行失败
--------------------------------------------------------------------------------------
备注     :  frequency的取值范围:1-1000000(HZ)
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall StartStepMotor_Z(IN float distance, IN unsigned long frequency,
    IN unsigned long startFrequency, IN unsigned long speedUpTime);

/*************************************************************************************
函数名   : StopStepMotor_Z
功能     : Z轴停止转动
参数     :
返回值   : true  :   执行成功
           false :   执行失败
--------------------------------------------------------------------------------------
备注     :  无
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall StopStepMotor_Z();

/*************************************************************************************
函数名   : ReturnHome_R
功能     : R轴步进电机回零
参数     :

            frequency 步进电机控制信号的频率,单位:脉冲/s
返回值   : true 函数执行成功
           false 函数执行失败
--------------------------------------------------------------------------------------
备注     : frequency的取值范围:1-1000000(HZ)
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall ReturnHome_R(IN unsigned long frequency);


/*************************************************************************************
函数名   : StartStepMotor_R
功能     : R轴步进电机步进
参数     :
           angle  旋转角度,单位:度
           frequency 步进电机控制信号的频率,单位:脉冲/s
           startFrequency 起始频率，脉冲/s
           speedUpTime    加速时间，us
返回值   : true 函数执行成功
           false 函数执行失败
--------------------------------------------------------------------------------------
备注     :  frequency的取值范围:1-1000000(HZ)
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall StartStepMotor_R(IN float angle, IN unsigned long frequency,
    IN unsigned long startFrequency, IN unsigned long speedUpTime);

/*************************************************************************************
函数名   : StopStepMotor_R
功能     : R轴停止转动
参数     :
返回值   : true  :   执行成功
           false :   执行失败
--------------------------------------------------------------------------------------
备注     :  无
--------------------------------------------------------------------------------------
*************************************************************************************/
bool __stdcall StopStepMotor_R();
//////////////////////////////////////////////////////////////////////////////////////Control Command

/////////////////////////////////////////////////////////////////////////////////////////List Command
/****************************************************************************************
函数名   : <MoveStepMotorCommand_XY>
功能     : XY轴联动命令
参数     :

            startPositionX X轴的起始位置  单位:mm
            startPositionY Y轴的起始位置  单位:mm
            endPositionX X轴的结束位置  单位:mm
            endPositionY Y轴的结束位置  单位:mm
返回值   : 1: 成功
          -1: 失败
-----------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------
作者     :

****************************************************************************************/
int __stdcall MoveStepMotorCommand_XY(IN double startPositionX, IN double startPositionY,
    IN double endPositionX, IN double endPositionY);

/****************************************************************************************
函数名   : MoveStepMotorCommand_Z
功能     : Z轴命令
参数     :

            startPosition 开始位置  单位:mm
            endPosition 结束位置  单位:mm
返回值   : 1: 成功
          -1: 失败
-----------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------
作者     :

****************************************************************************************/
int  __stdcall  MoveStepMotorCommand_Z(IN double startPosition, IN double endPosition);

/****************************************************************************************
函数名   : RotateStepMotorCommand_R
功能     : 旋转命令
参数     :

            angle 旋转角度
返回值   : 1: 成功
          -1: 失败
-----------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------
作者     :
****************************************************************************************/
int  __stdcall  RotateStepMotorCommand_R(IN float angle);
/////////////////////////////////////////////////////////////////////////////////////////List Command
//#######################################################################################  步进电机命令
//#####################################################################################################

//#####################################################################################################
//#############################################################################################延时命令
/****************************************************************************************************
函数名   : DelayCommand
功能     : 延时命令
参数     :

            delay 延时时间  单位:1us
返回值   : 1: 成功
          -1: 失败
-----------------------------------------------------------------------------------------------------
备注    : 范围 1 - 134217728 us
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
int  __stdcall  DelayCommand(IN int delay);

//#############################################################################################延时命令
//#####################################################################################################

//#####################################################################################################
//#############################################################################################标刻命令
/****************************************************************************************************
函数名   : MarkCommand_Point
功能     : 矢量图命令分解
参数     :

            x 指定X坐标
            y 指定Y坐标
            type 控制类型，0: tp为出光个数 1:tp为出光时间
            tp   根据type指定，表示出光个数或者是出光时间
返回值   : 1: 执行成功
          -1: 执行失败
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
int __stdcall MarkCommand_Point(IN double x, IN double y, IN int type, IN int tp);

/****************************************************************************************************
函数名   : MarkCommand_Vector
功能     : 矢量图命令分解
参数     :

            length  数组长度
            sitsetX 矢量图 X坐标 数组的指针
            sitsetY 矢量图 Y坐标 数组的指针
返回值   : 1: 执行成功
          -1: 执行失败
-----------------------------------------------------------------------------------------------------
备注     : pointNum只有length为1时有效
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
int __stdcall MarkCommand_Vector(IN int length, IN double* sitsetX, IN double* sitsetY);

/****************************************************************************************************
函数名   : MarkCommand_Bitmap
功能     : 位图命令分解
参数     :

            length  数组长度
            sitsetX 位图象素点 X坐标 数组的指针
            sitsetY 位图象素点 Y坐标 数组的指针
            sitsetGray 位图象素点 灰度 数组的指针
返回值   : 1: 执行成功
          -1: 执行失败
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
int  __stdcall  MarkCommand_Bitmap(IN int length, IN double* sitsetX, IN double* sitsetY, IN int* sitsetGray);

//#############################################################################################标刻命令
//#####################################################################################################

//#####################################################################################################
//#############################################################################################换笔命令
/****************************************************************************************************
函数名   : ChangePensCommand
功能     : 换笔号命令
参数     :

            unsigned char pen 目标笔号
返回值   : 1: 成功
          -1: 失败
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
int __stdcall ChangePensCommand(IN unsigned char pen);
//############################################################################################换笔命令
//#####################################################################################################

//#####################################################################################################
//#########################################################################################标刻结束命令
/****************************************************************************************************
函数名   : EndCommand
功能     : 结束命令
参数     :
返回值   : 1: 成功
          -1: 失败
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
int  __stdcall  EndCommand();

//##########################################################################################标刻结束命令
//#####################################################################################################

//#####################################################################################################
//#############################################################################################跳转命令

//////////////////////////////////////////////////////////////////////////////////////Control Command
/****************************************************************************************************
函数名   : Goto_XY
功能     : 振镜跳转函数
参数     :

            x 指定X坐标
            y 指定Y坐标
返回值   : 1: 成功
          -1: 失败
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
*****************************************************************************************************/
int __stdcall Goto_XY(IN double x, IN double y);

/****************************************************************************************************
函数名   : Offset_Z
功能     : Z轴偏移
参数     :

            offsetZ  偏移量，单位：mm
返回值   : 1: 成功
          -1: 失败
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
****************************************************************************************************/
int  __stdcall Offset_Z(IN double offsetZ);
//////////////////////////////////////////////////////////////////////////////////////Control Command


/////////////////////////////////////////////////////////////////////////////////////////List Command
/*****************************************************************************************************
函数名   : JumpCommand
功能     : 振镜跳转函数
参数     :

            x 指定X坐标
            y 指定Y坐标
返回值    :  true  成功
             false 失败
*****************************************************************************************************/
bool __stdcall JumpCommand(IN double x, IN double y);


/****************************************************************************************************
函数名   : JumpCommand_Z
功能     : Z轴偏移
参数     :

            offsetZ  偏移量，单位：mm
返回值   : 1: 成功
          -1: 失败
-----------------------------------------------------------------------------------------------------
备注     :
-----------------------------------------------------------------------------------------------------
作者     :
*****************************************************************************************************/
int  __stdcall JumpCommand_Z(IN double offsetZ);

/////////////////////////////////////////////////////////////////////////////////////////List Command
//#############################################################################################跳转命令
//#####################################################################################################

//#####################################################################################################
//#########################################################################################获取采样坐标
/****************************************************************************************************
函数名    :  EnableCorrect
功能      :  设置获取采样坐标使能
参数	  :

            able=1;有效
            able=0;无效
返回值    :  true  函数执行成功
             false 函数执行失败
-----------------------------------------------------------------------------------------------------
备注      :  无
-----------------------------------------------------------------------------------------------------
作者      :
****************************************************************************************************/
bool __stdcall EnableCorrect(IN int able);

/****************************************************************************************************
函数名    :  GetCorrectionData
功能      :  获取采样点数据
参数	  :

            xCoordinate: X点校正坐标,
            yCoordinate: Y点校正坐标,

            number: 已经读取的脉冲信号个数
返回值    :  1  : 校正函数执行成功
             -1 : 执行读取X、Y坐标点，坐标点的数目失败
             -2 : 执行高电平清零失败
             -3 : 执行低电平清零失败
-----------------------------------------------------------------------------------------------------
备注      :  无
-----------------------------------------------------------------------------------------------------
作者      :
****************************************************************************************************/
int __stdcall GetCorrectionData(OUT unsigned short& xCoordinate, OUT unsigned short& yCoordinate, OUT unsigned short& number);

//#########################################################################################获取采样坐标
//#####################################################################################################

//#####################################################################################################
//#########################################################################################动态轴授权
/****************************************************************************************************
函数名    :  License
功能      :  给出授权文件。授权成功则会输出动态轴信号，否则不输出该信号
参数	  :

            filePath ： 授权文件路径(完整路径)
返回值    :  true  函数执行成功
             false 函数执行失败
-----------------------------------------------------------------------------------------------------
备注      :  2011-7-21 添加授权
-----------------------------------------------------------------------------------------------------
作者      :
****************************************************************************************************/
bool __stdcall License(IN char* filePath);

//#########################################################################################动态轴授权
//#####################################################################################################

#endif // CSCINTERFACE_H